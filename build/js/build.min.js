const getResource=async e=>{const t=await fetch("http://localhost:3000/"+e);if(!t.ok)throw new Error(`Could not fetch http://localhost:3000/presents/${e}, status ${t.status}`);return await t.json()},sendRequest=(e,t={})=>fetch(e,t).then(e=>e.json()),createElement=function({attrs:e={},styles:t={},handlers:n={},data:a=[],type:r="div",forAttr:s,text:i,html:c,className:o,id:l,parent:d}){const m=document.createElement(r);for(const t in e)m[t]=e[t];for(const e in t)m.style[e]=t[e];for(const e in n)m.addEventListener(e,n[e].bind(m));return a.forEach(e=>{m.setAttribute(e.key,e.value)}),s&&m.setAttribute("for",s),l&&(m.id=l),o&&(m.className=o),i&&(m.innerText=i),c&&(m.innerHTML=c),d&&d.appendChild(m),m},filtersRadioData=[{value:"От дорогих к дешевым"},{value:"От дешевых к дорогим"}];function getBrandName(e){const t=new Map;return e.forEach(e=>t.set(e.brand,e.brand)),t}function showFilter(){const e=document.querySelector(".shop__flex-container");document.querySelectorAll(".header .nav__link").forEach(t=>t.addEventListener("click",()=>{const t=event.target.getAttribute("data-category");getResource(t).then(t=>createFilter(t,e))}))}function createFilter(e,t){const n=document.querySelector(".filters");n&&n.remove();const a=createElement({type:"aside",className:"filters",id:"filters",parent:t}),r=createElement({type:"div",className:"filters__header",parent:a}),s=(createElement({type:"h2",className:"shop__title",text:"Фильтр",parent:r}),createElement({type:"div",className:"filters__content",parent:a})),i=createElement({type:"div",className:"filters__block",parent:s});createElement({type:"h2",text:"По брендам",className:"filters__title",parent:i});getBrandName(e).forEach((function(e){const t=createElement({type:"div",className:"choose-service__item filters__item",parent:i});createElement({type:"input",attrs:{name:e,type:"checkbox"},id:e,className:"choose-service__input",parent:t}),createElement({type:"label",forAttr:e,className:"choose-service__checkbox",parent:t}),createElement({type:"label",forAttr:e,className:"choose-master__text",text:e,parent:t})}));createElement({type:"h2",text:"По цене",className:"filters__title",parent:i});filtersRadioData.forEach((function(e){const t=createElement({type:"div",className:"choose-service__item filters__item",parent:i});createElement({type:"input",attrs:{name:"choose-master__item",type:"radio"},id:"filter-"+filtersRadioData.indexOf(e),className:"choose-master__radio",parent:t}),createElement({type:"label",forAttr:"filter-"+filtersRadioData.indexOf(e),className:"choose-master__label",parent:t}),createElement({type:"label",forAttr:"filter-"+filtersRadioData.indexOf(e),className:"choose-master__text",text:e.value,parent:t})}));const c=createElement({type:"div",className:"filters__btn-submit",parent:a});createElement({type:"button",className:"btn btn--black",id:"btnShowFilter",text:"Фильтр",parent:c}).addEventListener("click",handleCheckFilter)}function handleCheckFilter(){const e=document.querySelectorAll(".choose-service__input"),t=document.querySelector(".shop__flex-container"),n=document.querySelector(".shop__cards").getAttribute("id"),a=[];e.forEach(e=>{e.checked&&a.push(e.name)}),getResource(n).then(e=>{const r=[];e.forEach(e=>{a.forEach(t=>{e.brand===t&&r.push(e)})});document.querySelectorAll(".choose-master__radio").forEach(a=>{a.checked&&"filter-0"===a.id?0===r.length?(e.sort((e,t)=>Number(e.price)>Number(t.price)?1:-1),e.reverse(),console.log(e),createCards(e,t,n)):(r.sort((e,t)=>Number(e.price)>Number(t.price)?1:-1),r.reverse(),createCards(r,t,n)):a.checked&&"filter-1"===a.id?0===r.length?(e.sort((e,t)=>Number(e.price)>Number(t.price)?1:-1),createCards(e,t,n)):(r.sort((e,t)=>Number(e.price)>Number(t.price)?1:-1),createCards(r,t,n)):0===r.length?createCards(e,t,n):createCards(r,t,n)})})}const showBasket=()=>{basketProductCounter(),basketBtn()},basketBtn=()=>{const e=document.getElementById("basketBtn");JSON.parse(localStorage.getItem("basket")).length>0?(e.removeEventListener("click",handleShowBasketNull),e.addEventListener("click",handleShowBasket)):(e.removeEventListener("click",handleShowBasket),e.addEventListener("click",handleShowBasketNull))},basketProductCounter=()=>{const e=document.getElementById("basketCounter"),t=JSON.parse(localStorage.getItem("basket"));e.innerText=t.length},handleShowBasketNull=()=>{basketBtn();const e=document.querySelector(".shop__flex-container");e.innerHTML=" ";const t=document.createElement("div");t.classList.add("productBasket"),e.appendChild(t),t.innerHTML='<h2 class="productBasket__basket-null">Ваша корзина пуста,начните покупки!</h2>',basketProductCounter()},handleShowBasket=()=>{basketProductCounter();const e=document.querySelector(".shop__flex-container");e.innerHTML=" ";const t=document.createElement("div");t.classList.add("productBasket"),e.appendChild(t);const n=JSON.parse(localStorage.getItem("basket")),a=[];n.forEach(e=>{let t=JSON.stringify(e);a.push(t)});const r=getUniqueArr(a),s=[];r.forEach(e=>{let t=JSON.parse(e);s.push(t)}),n.length>1?s.forEach(e=>{createBasketCard(e,t)}):createBasketCard(n[0],t);document.querySelectorAll("#basketDeleteItemBtn").forEach(e=>{e.addEventListener("click",handleDeleteProduct)}),formCheckout()},counterProduct=e=>{const t=JSON.parse(localStorage.getItem("basket"));let n=0;return t.forEach(t=>{e.id===t.id&&n++}),n},handleDeleteProduct=()=>{const e=event.target.getAttribute("data-id"),t=JSON.parse(localStorage.getItem("basket")),n=t.find(t=>t.id===Number(e)),a=t.indexOf(n);t.splice(a,1),localStorage.setItem("basket",JSON.stringify(t));JSON.parse(localStorage.getItem("basket")).length>0?handleShowBasket():handleShowBasketNull()},createBasketCard=(e,t)=>{let n=counterProduct(e);const a=document.createElement("div");a.classList.add("productBasket__item"),a.innerHTML=`\n        <div class="productBasket__img-container" data-id=${e.id}>\n                <img src="${e.img}" alt="" class="productBasket__img">\n        </div>\n        <div class="productBasket__content" data-id=${e.id}>\n        <h3 class="productBasket__title">\n            ${e.name}\n        </h3>\n        <p class="productBasket__counter-container">\n            <span class="productBasket__counter-title">Количество:</span>\n            <span class="productBasket__counter-counter" id="counter">${n}</span>\n        </p>\n        <p class="productBasket__price">\n            ${e.price} грн\n        </p>\n        <div class="productBasket__buttons">\n            <button class="productBasket__btnDelete btn btn--black" id="basketDeleteItemBtn" data-id="${e.id}">Убрать из корзины</button>\n        </div>\n    `,t.appendChild(a)},getUniqueArr=e=>Array.from(new Set(e)),getCountPrice=()=>{const e=JSON.parse(localStorage.getItem("basket"));let t=0;return e.forEach(e=>{t+=Number(e.price)}),t},start=()=>{localStorage.getItem("basket")||localStorage.setItem("basket","[]");const e=document.querySelector(".shop__flex-container"),t=document.querySelector(".header .nav__link").getAttribute("data-category");handlerNavLink(),basketProductCounter(),basketBtn(),window.addEventListener("DOMContentLoaded",()=>{getResource(t).then(t=>createFilter(t,e)),getResource(t).then(n=>createCards(n,e,t))})},handlerNavLink=()=>{document.querySelectorAll(".header .nav .nav__link").forEach(e=>e.addEventListener("click",showProducts))},showProducts=e=>{const t=document.querySelector(".shop__flex-container");t.innerHTML=" ";const n=e.target.getAttribute("data-category");getResource(n).then(e=>{createFilter(e,t),createCards(e,t,n)})},createCards=(e,t,n)=>{const a=document.querySelector(".shop__cards");a&&a.remove();const r=document.createElement("div");r.classList.add("shop__cards"),r.id=n,t.appendChild(r),e.forEach(t=>{createCard(t,r,e)});document.querySelectorAll("#addInBasket").forEach(t=>{t.addEventListener("click",handleAddInBasket.bind(this,e))})},createCard=(e,t,n)=>{const a=createElement({className:"product",parent:t,html:`<div class="product__img-container">\n            <img src="${e.img}" alt="" class="product__img">\n    </div>\n    <div class="product__content">\n            <h3 class="product__title">\n                ${e.name}\n            </h3>\n            <p class="product__price">\n                ${e.price} грн\n            </p>\n            <div class="product__buttons">\n                <button class="btn btn--black" data-id=${e.id}>Посмотреть</button>\n                <button class="btn btn--plus"></button>\n            </div>`});document.querySelectorAll(".product__img").forEach(e=>{e.style.width="100%"}),a.addEventListener("click",handlerProductItem.bind(null,n))},handlerProductItem=(e,t)=>{const n=t.target;if("btn btn--black"!==n.className)return;const a=n.getAttribute("data-id"),r=e.find(e=>e.id===Number(a));activeLink("descriptions","reviews"),showDetailInfo(r)},showDetailInfo=e=>{document.querySelector(".shop .wrapper .shop-content .shop__flex-container").innerHTML="";const t=document.querySelector(".shop__flex-container");createElement({className:"product-info",parent:t,html:`<div class="product-info__img">\n      <img src=${e.img} alt="product img"/>\n  </div>\n  <div class="product-info__info">\n      <div class="product-info__link-container">\n          <a class="product-info__link product-info__link--active" id="descriptions">Описание</a>\n          <a class="product-info__link" id="reviews">Отзывы</a>\n      </div>\n      <div class="product-info__descriptions">\n          <div class="product-info__title-container">\n               <h2 class="product-info__title">${e.name}</h2>\n              <p class="product-info__description">${e.descriptions}</p>\n           </div>\n          <div class="product-info__price-container">\n               <p class="product-info__price">${e.price} грн</p>\n              <button class="btn btn--plus"></button>\n          </div>\n      </div>\n  </div>`}),document.getElementById("reviews").addEventListener("click",handlerReview.bind(null,e)),document.getElementById("descriptions").addEventListener("click",handlerDescriptions.bind(null,e))},handlerReview=e=>{const t=document.querySelector(".product-info__descriptions");t.innerHTML=" ",activeLink("reviews","descriptions"),t.innerHTML='\n        <div class="popup__comment-container">\n            <div class="form-group">\n                <input type="email" class="form-control" id="emailForm" placeholder="Enter your email...">\n            </div>\n                <textarea class="popup__comment" name="review" id="review" placeholder="Please leave your review..." cols="72" rows="5"></textarea>\n            </div>\n        </div>\n        <div class="appointment-form__btn">\n            <button type="submit" class="btn btn--orange" id="btnSend">Отправить</button>\n        </div> \n        <div class="comments"></div>\n    ';const n=document.querySelector(".comments");document.querySelectorAll(".product__img").forEach(e=>{e.style.width="100%"}),showComments(n,e),document.querySelector("#btnSend").addEventListener("click",handlerPostSend.bind(null,n,e))},handlerDescriptions=e=>{document.querySelector(".product-info__descriptions").innerHTML=""},handleAddInBasket=e=>{const t=event.target.getAttribute("data-id"),n=e.find(e=>e.id===Number(t));let a=JSON.parse(localStorage.getItem("basket"));a.push(n),localStorage.setItem("basket",JSON.stringify(a));document.getElementById("basketCounter").innerHTML=a.length;document.getElementById("basketBtn").addEventListener("click",handleShowBasket)},handlerPostSend=(e,t,n)=>{n.preventDefault();const a=document.getElementById("emailForm").value,r=document.querySelector("#review").value,s={};s.texts=r,s.email=a,s.productId=t.id,createElement({html:`<div class="container">\n    <p>${a}</p>\n    <p class="lead">${r}</p>\n  </div>`,parent:e,className:"jumbotron jumbotron-fluid"}),sendRequest("http://localhost:3000/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})},showComments=(e,t)=>{getResource("commit").then(n=>n.forEach(n=>{n.productId===t.id&&createElement({html:`\n            <div class="container">\n                <p>${n.email}</p>\n                <p class="lead">${n.texts}</p>\n            </div>\n        `,parent:e,className:"jumbotron jumbotron-fluid"})}))},activeLink=(e,t)=>{document.getElementById(e).classList.add("product-info__link--active"),document.getElementById(t).classList.remove("product-info__link--active")};start();const formCheckout=()=>{const e=document.querySelector(".shop__flex-container"),t=createElement({type:"div",className:"checkout",parent:e});createElement({type:"div",className:"checkout__price",parent:t,text:`Цена: ${getCountPrice()} грн`});createElement({type:"button",className:"btn btn--orange",id:"checkoutBtn",parent:t,text:"Оформить заказ"}).addEventListener("click",handleShowForm)},handleShowForm=()=>{deleteForm();const e=document.querySelector(".shop-content"),t=document.createElement("div");t.classList.add("formCheckout"),e.appendChild(t),t.innerHTML='\n    <div class="row">\n        <section class="section">\n            <header>\n                <h3>Оформление заказа</h3>\n                <h4>Введите контактную информацию</h4>\n                <button class="btnDeleteForm" id="btnDelete">\n                </button> \n            </header>\n            <main>\n                <form>\n                    <div class="form-item box-item">\n                        <input type="text" name="name" placeholder="Имя Фамилия" data-name data-required>\n                        <small class="errorReq"><i class="fa fa-asterisk" aria-hidden="true"></i>Поле заполнено\n                            неверно</small>\n                    </div>\n                    <div class="form-item box-item">\n                        <input type="email" name="email" placeholder="Email" data-email data-required>\n                        <small class="errorReq"><i class="fa fa-asterisk" aria-hidden="true"></i> Поле заполнено\n                            неверно</small>\n                        <small class="errorEmail"><i class="fa fa-asterisk" aria-hidden="true"></i> email is not\n                            valid</small>\n                    </div>\n                    <div class="form-item box-item">\n                        <div class="form-item-triple">\n                            <div class="radio-label">\n                                <label class="label">Оплата</label>\n                            </div>\n                            <div class="form-item">\n                                <input id="onSite" type="radio" name="gender" value="onSite" data-once>\n                                <label for="onSite">На сайте</label>\n                            </div>\n                            <div class="form-item">\n                                <input id="onDelivery" type="radio" name="gender" value="onDelivery" data-once>\n                                <label for="onDelivery">При получении</label>\n                            </div>\n                        </div>\n                        <small class="errorOnce"><i class="fa fa-asterisk" aria-hidden="true"></i> Выберите способ\n                            оплаты</small>\n                    </div>\n                    <div class="form-item box-item">\n                        <div class="form-item-triple">\n                            <div class="radio-label">\n                                <label class="label">Получение</label>\n                            </div>\n                            <div class="form-item">\n                                <input id="receiving" type="radio" name="receiving" value="pickup" data-once>\n                                <label for="receiving">Самовывоз</label>\n                            </div>\n                            <div class="form-item">\n                                <input id="receiving2" type="radio" name="receiving" value="novaPoshta" data-once>\n                                <label for="receiving2">Новая Почта</label>\n                            </div>\n                        </div>\n                        <small class="errorOnce"><i class="fa fa-asterisk" aria-hidden="true"></i> Выберите способ\n                            доставки</small>\n                    </div>\n                    <div class="form-item box-item">\n                        <input type="text" name="address" placeholder="Адрес" data-required>\n                        <small class="errorReq"><i class="fa fa-asterisk" aria-hidden="true"></i> Адрес не\n                            введен</small>\n                    </div>\n                    <div class="form-item box-item">\n                        <input type="text" name="phone" placeholder="Номер телефона(+380*********)" data-required\n                            data-number>\n                        <small class="errorNum"><i class="fa fa-asterisk" aria-hidden="true"></i> Введите номер типа\n                            +380*********</small>\n                    </div>\n                    <div class="form-item">\n                        <span id="submit" class="submit">Submit</span>\n                    </div>\n                </form>\n            </main>\n            <footer>\n            </footer>\n            <i class="wave"></i>\n        </section>\n    </div>',formValidate();const n=document.getElementById("btnDelete");console.log(n),n.addEventListener("click",deleteForm)},formValidate=()=>{let e=function(){let e=/^\w+@\w+\.\w+/,t=/\+380\d{6,9}$/,n=/[A-Z, А-Я][a-z, а-я]{1,} [A-Z, А-Я][a-z, а-я]{1,}/;return{isName:function(e){return n.test(e)},isEmail:function(t){return e.test(t)},isNumber:function(e){return t.test(e)},isRequire:function(e){return""==e},isChecked:function(e){let t=!1;return e.each((function(){$(this).prop("checked")&&(t=!0)})),t}}}(),t=$("form").find("[data-name]"),n=$("form").find("[data-required]"),a=$("form").find("[data-number]"),r=$("form").find("[data-email]"),s=$("form").find("[data-once]"),i=$(".form-item-triple"),c=[];i.each((function(){c.push($(this).find("[data-once]"))})),$("#submit").on("click",(function(){n.each((function(){e.isRequire($(this).val())&&$(this).siblings("small.errorReq").show()})),t.each((function(){e.isName($(this).val())||$(this).siblings("small.errorReq").show()})),r.each((function(){e.isEmail($(this).val())||$(this).siblings("small.errorEmail").show()})),$.each(c,(function(){e.isChecked($(this))||$(this).parents(".form-item").find("small.errorOnce").show()})),a.each((function(){e.isNumber($(this).val())||$(this).siblings("small.errorNum").show()}))})),n.on("keyup blur",(function(){e.isRequire($(this).val())||$(this).siblings("small.errorReq").hide()})),t.on("keyup blur",(function(){e.isName($(this).val())&&$(this).siblings("small.errorReq").hide()})),r.on("keyup blur",(function(){e.isEmail($(this).val())&&$(this).siblings("small.errorEmail").hide()})),s.on("change",(function(){$.each(c,(function(t){e.isChecked(c[t])&&c[t].parents(".form-item").find("small.errorOnce").hide()}))})),a.on("keyup blur",(function(){e.isNumber($(this).val())&&$(this).siblings("small.errorNum").hide()}))},deleteForm=()=>{const e=document.querySelector(".formCheckout");e&&e.remove()};
//# sourceMappingURL=build.min.js.map
